(()=>(e,t)=>{(async()=>{if(!document.URL.match(/^https:\/\/live.bilibili.com\/(blanc\/)?(\d+)/)){return}const e=await SpinQuery.select(".bilibili-live-player-video-controller");console.log("DSB",e);if(!e){return}t.applyStyle("danmakuSendBarStyle");let n=false;Observer.childList(e,(async()=>{if(!dq(e,".control-area")){return}const t=dq(e,".left-area");const a=await SpinQuery.select(".chat-input-ctnr .chat-input");const i=await SpinQuery.select(".chat-input-ctnr ~ .bottom-actions .bl-button--primary");if([t,a,i].some((e=>e===null))){return}const l=Vue.extend({template:`\n<div class="danmaku-send-bar">\n<input\n          type="text"\n          placeholder="发个弹幕呗~"\n          :value="value"\n          @keydown.enter="send()"\n          @input="updateValue($event.target.value)"\n          maxlength="30"\n        />\n</div>\n`,data(){return{value:a.value}},mounted(){a.addEventListener("input",this.listenChange);a.addEventListener("change",this.listenChange);if(!n){const e=Object.getOwnPropertyDescriptors(HTMLTextAreaElement.prototype).value;Object.defineProperty(a,"value",{...e,set(t){e.set.call(this,t);raiseEvent(a,"input")}});n=true}},beforeDestroy(){a.removeEventListener("input",this.listenChange);a.removeEventListener("change",this.listenChange)},methods:{updateValue(e){a.value=e;raiseEvent(a,"input")},send(){if(!i.disabled){this.value="";i.click()}},listenChange(e){this.value=e.target.value}}});const r=(new l).$mount().$el;t.insertAdjacentElement("afterend",r)}))})();return{reload:()=>document.body.classList.remove("danmaku-send-bar-unloaded"),unload:()=>document.body.classList.add("danmaku-send-bar-unloaded")}})();