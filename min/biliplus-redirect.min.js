(()=>(i,e)=>{const o=`www.biliplus.com`;const n=["bilibili.com/video/","bilibili.com/bangumi/play","space.bilibili.com"];return{widget:{condition:()=>n.some((i=>document.URL.includes(i))),content:`\n<a class="gui-settings-flat-button" id="biliplus-redirect">\n<i class="icon-biliplus"></i>\n<span>转到BiliPlus</span>\n</a>`,success:()=>{const i=document.querySelector("#biliplus-redirect");const e=/\/video\/(av[\d]+|BV.+)/i;const n=()=>{i.href="";i.disabled=true};const c=e=>{if(document.URL!==e){i.href=e}else{n()}};if(location.host==="space.bilibili.com"){const i=document.URL.replace("space.bilibili.com/",`${o}/space/`);c(i)}else if(document.URL.includes("/bangumi/play")){c(`https://${o}${window.location.pathname}${window.location.search}`);Observer.videoChange((()=>{const i=document.querySelector(".av-link,.info-sec-av");const e=unsafeWindow.aid||i.innerText.replace(/[aAvV]/g,"");const n=`https://${o}/video/av${e}/`;c(n)}))}else if(e.test(document.URL)){const[,i]=document.URL.match(e);c(`https://${o}/video/${i}/`)}else{Observer.videoChange((()=>{const i=document.URL.replace(window.location.host,o);c(i)}))}}}}})();