(()=>(i,n)=>{const e=["https://www.bilibili.com/video/","https://www.bilibili.com/bangumi/"].some((i=>document.URL.startsWith(i)));return{widget:{content:`<div class="bvid-convert"></div>`,condition:async()=>{if(e){return Boolean(await SpinQuery.select((()=>unsafeWindow.aid||unsafeWindow.bvid)))}else{return false}},success:()=>{n.applyStyle("bvidConvertStyle");const i=(i,n)=>{if(!i||!n){return""}return`\n<div class="bvid-convert-item">av${i}<i class="mdi mdi-link aid"></i></div>\n<div class="bvid-convert-item">${n}<i class="mdi mdi-link bvid"></i></div>\n`};const e=dq(".bvid-convert");e.addEventListener("click",(i=>{const n=i.target;const e=n.classList;if(e.contains("mdi")){if(e.contains("mdi-check")){return}const i=n.previousSibling;if(i){GM_setClipboard(`https://www.bilibili.com/video/${i.textContent}?${window.location.search}`,{mimetype:"text/plain"});e.remove("mdi-link");e.add("mdi-check");setTimeout((()=>{e.remove("mdi-check");e.add("mdi-link")}),1e3)}}}));const t=async()=>{const n=dq(".bvid-convert");n.innerHTML=i(unsafeWindow.aid,unsafeWindow.bvid);const e=await SpinQuery.select(".av-link,.bv-link,.bvid-link");if(e){n.innerHTML=i(unsafeWindow.aid,e.innerHTML)}};Observer.videoChange(t)}}}})();