(()=>(t,e)=>{const i=/@(\d+)[Ww]_(\d+)[Hh]/;const n=t.imageResolutionScale==="auto"?window.devicePixelRatio:parseFloat(t.imageResolutionScale);const o=["#certify-img1","#certify-img2"];const r=(t,e)=>{const i=document.createNodeIterator(t,NodeFilter.SHOW_ELEMENT,null);let n=i.nextNode();while(n){if(n instanceof HTMLElement){e(n)}n=i.nextNode()}};async function s(t){const e=(e,r)=>{const s=e(t);if(s===null){return}if(o.some((e=>t.matches(e)))){return}const a=s.match(i);if(!a){return}let[,l,c]=a;let u=parseInt(t.getAttribute("data-resolution-width")||"0");if(parseInt(l)>=u&&u!==0){return}if(t.getAttribute("width")===null&&t.getAttribute("height")===null){if(t.classList.contains("bili-avatar-img")){t.setAttribute("height",c)}else{t.setAttribute("width",l)}}l=Math.round(n*parseInt(l)).toString();c=Math.round(n*parseInt(c)).toString();t.setAttribute("data-resolution-width",l);r(t,s.replace(i,`@${l}w_${c}h`))};Observer.attributes(t,(()=>{e((t=>t.getAttribute("src")),((t,e)=>t.setAttribute("src",e)));e((t=>t.style.backgroundImage),((t,e)=>t.style.backgroundImage=e))}))}const a=async()=>{r(document.body,(t=>s(t)));Observer.childListSubtree(document.body,(t=>{for(const e of t){for(const t of e.addedNodes){if(t instanceof HTMLElement){s(t);if(t.nodeName.toUpperCase()!=="IMG"){r(t,(t=>s(t)))}}}}}))};a();e.applyStyleFromText(`\n.favInfo-box .favInfo-cover img {\n  width: 100% !important;\n  object-position: left !important;\n}\n.bb-comment .sailing .sailing-img,\n.comment-bilibili-fold .sailing .sailing-img {\n  width: 288px;\n}\n`,"image-resolution-fix");return{export:{imageResolution:s}}})();