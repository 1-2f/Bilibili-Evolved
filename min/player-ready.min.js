(()=>(n,o)=>{const e=()=>new Promise((async(n,o)=>{const e=document.URL.replace(window.location.search,"")==="https://www.bilibili.com/blackboard/newplayer.html"&&document.URL.includes("fjw=true");if(e){return}await SpinQuery.condition((()=>unsafeWindow),(()=>unsafeWindow.UserStatus!==undefined));if(unsafeWindow.onLoginInfoLoaded){unsafeWindow.onLoginInfoLoaded(n)}else{logError(new Error("utils.playerReady 失败"));console.error(`typeof onLoginInfoLoaded === ${typeof unsafeWindow.onLoginInfoLoaded}`);o()}}));const i=async()=>{if(unsafeWindow.aid){return unsafeWindow.aid}const n=await SpinQuery.condition((()=>{var n,o,e;return(n=unsafeWindow)===null||n===void 0?void 0:(o=n.player)===null||o===void 0?void 0:(e=o.getVideoMessage)===null||e===void 0?void 0:e.call(o)}),(n=>(n===null||n===void 0?void 0:n.aid)!==undefined)).catch((()=>{throw new Error("Cannot find aid")}));unsafeWindow.aid=n.aid;return n.aid};return{export:{playerReady:e,aidReady:i}}})();